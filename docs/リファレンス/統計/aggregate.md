---
sidebar_position: 1
---

# aggregate()

平均や最大値等の統計を行いたい場合に利用します。

## 使用できるキー

| キー名  | 内容               | 省略 | 備考                                          |
| ------- | ------------------ | ---- | --------------------------------------------- |
| where   | 取得条件の指定     | 可   | 書かない場合は全ての行を取得します            |
| orderBy | ソート設定         | 可   | 指定する列が 1 つの場合、配列の省略が可能です |
| take    | 取得数の設定       | 可   |
| skip    | スキップ数の設定   | 可   |
| \_avg   | 平均表示の設定     | 可   |
| \_count | ヒット数表示の設定 | 可   |
| \_max   | 最大値表示の設定   | 可   |
| \_min   | 最小値表示の設定   | 可   |
| \_sum   | 合計表示の設定     | 可   |

## 説明例用のシート

![説明用シート](../img/exampleSheet.png)

## 説明

上記例から以下の処理を行いたいとします。

- age => **平均を求める**
- age => **最大値を求める**
- age => **最低値を求める**

この場合以下のコードとなります。

```ts
// gassma.sheets.{{TARGET_SHEET_NAME}}.aggregate
const result = gassma.sheets.sheet1.aggregate({
  _avg: {
    age: true,
  },
  _max: {
    age: true,
  },
  _min: {
    age: true,
  },
});
```

戻り値は以下の形式です。

```ts
{
  _avg: { age: 33.333333333333336 },
  _max: { age: 55 },
  _min: { age: 20 }
}
```
